# Правила игры
Каждый раунд на стол выпадает 3 случайных карты.
Карта - это здание, которое может быть построено либо не построено.
В каждом раунде есть мэр. Мэры выбираются по кругу.
В начале раунда мэр договаривается с другими игроками какую карту выбрать. 
Нужно выбрать только одну карту на раунд.
После выбора карты мэр договаривается с другими игроками и выбирает команду (тех, кто будет строить здание).
На карте указано: 
    - сколько человек может быть в команде
    - сколько монет должна собрать команда, чтоб успешно построить здание
    - что произойдёт, если здание будет построено (зеленое поле)
- **Каждый в команде получает +10**: каждый из команды после успешной постройки единоразово получит по 10 монет.
- **Лидер получает переплату**: лидер получит всё, что превысит стоимость постройки. Например: для постройки здания надо 10 монет. Члены команды вложат суммарно 15. Лидер получит 5.
- **Лавочник(или другая должность) +15**: при успешной постройке должность получит тот из команды, кто больше вложил. Если все игроки команды вложили поровну, то должность получит мэр. 
Обладатель должности получает зарплату каждый раунд.
- **Эффекты**:
    - **Базовый доход +3**: все игроки в игре будут получать каждый раунд по 3 монеты
    - **Цена построек +3**: стоимость всех зданий увеличится на 3 монеты
    - **Случайный доход -10**: каждый раунд у случайный игрока будет отниматься -10 монет
    - **Награда за постройку -4**: награды за постройку всех зданий уменьшатся на 4 монеты
    - **Зарплаты +10**: зарплаты на всех должностях(у игроков и на картах) увеличатся на 10 монет

    - что произойдёт, если здание не будет построено (красное поле). Например:  
- **Эффекты**:  
    - **Лидер получает -10**: у лидер отнимется -10 монет
    - **Перераспределение Ростовщик +15**: должность Ростовщик перейдет к игроку из команды, который больше всех вложил (при этом здание не было построено)

После выбора команды ход переходит по очереди к игрокам команды.
Игрок команды должен вложить в проект(постройку здания) любое количество монет.

После того, как все из команды сходили,объявляется результат раунда и применяются соответствующие эффекты.
Далее начинается следующий раунд с новым лидером.

## Миссии
У каждого игрока есть своя миссия, которая неизвестна другим игрокам. При её выполнении игрок получит указанное количество монет. При провале - не получит ничего.
**Виды миссий**:
- Провалить постройку n зданий как член команды. Непутёвый подрядчик
- Успешно построить n зданий как член команды. Строитель года
- Провалить постройку n зданий как мэр. 
- Успешно построить n зданий как мэр. 
- Вложить за раз в постройку n монет. Меценат
- Будучи мэром, ни разу не получить переплату. Честный мэр
- В течение игры должно быть построено здание n уровня
- В течение игры не должно быть построено ни одно здание n уровня
- Заработать n монет

В игре 15 раундов.
Побеждает тот, кто наберёт больше монет.

# TODO:
- [ ] протестировать локально. если все ок - то развернуть на сервере

# FIXES:
- иногда перестают показываться всплывающие окна (здание построено или здание не построено)
- перераспределение ролей при провале не работает как задумывалось (кто больше вкинул, но при этом в раунде был провал - не получает чин. чин остается у того же игрока)
- [ ] fix: Когда игра закончена и отображены результаты, если хост нажмет "закрыть" результаты и "начать игру", а остальные игроки не нажали "закрыть" результаты, то хост попадает в игру, а игроки остаются в лобби
- [ ] fix: для всех карт в деке несмотря на tier карты, ограничить max_team количеством игроков в игре
- [ ] fix: не давать нажать подтвердить выбор команды пока не выбрано нужное кол-во игроков

# FEATURES:
- [ ] I feat: reconnect (обработка события выхода из лобби)
показывать, что игрок вышел из игры
игрок может войти обратно
- [ ] doc: правила игры
- [ ] I feat: создать несколько колод - колода на 4ых игроков, колода на 5ых ...
- [ ] II feat: выбор названия города в лобби
- [ ] III feat: cделать возврат в сессию (если игрок случайно закрыл вкладку, а потом снова открыл её)
- [ ] ? feat: возможность дать деньги другому игроку
- [ ] ? feat: после выбора карточки лидер сам решает сколько участников взять в команду
- [ ] ? feat: порядок хода членов команды должен быть не последовательный, а асинхронный
- [ ] feat: создать новую игру тем же составом
- [ ] feat: записать миссии(кто выполнил/не выполнил) в результаты игры

# TESTS:
- [ ] написать тесты для функций, которые не используют бд и сокеты
- [ ] apply_effects, 
- [ ] cancel_effects, 
- [ ] populate_...,
- [ ] браузерные тесты

# IDEAS: ЦЕЛЬ - игра должна подталкивать на веселое поведение
- растянуть штрафы на много раундов
- добавить мотивацию для лидера: (д.б. бонус и штраф для лидера)
- перед выбором команды лидер должен иметь какой-то бонус
- больше карточек на команду из 3+ игроков, а не на 1-2 игрока
- на 2ух игроков - более специфичные карты
- Добавить кроме очков(ликвидных) неликвидные активы, которые влияют на подсчет рейтинга: игрок выбирает либо получить 20 очков, либо актив стоимостью 15, который он уже (почти никогда) не теряет
### Спецкарты:
- взять кредит - оплатить постройку, но должен вернуть через 2 хода
- узнать сколько очков у конкретного игрока
- отодвинуть расплату на следующий ход
- остаться лидером еще на один ход
- тебя не могут выбрать в команду в следующем ходе
- удваивается количество очков, которые ты получишь если построишь в следующем раунде, когда будешь в команде
### Эффекты карт:
- Условие на некоторых карточках: Кто вкинул больше всех избегает наказания (или получает меньшее наказание)
- карточка на 2ух, которая меняет количество очков у игроков при провале, а при успехе - х50% очки для каждого
- Переплата идет тому, кто больше вложил, кто меньше вложил или лидеру
- Временная видимость очков игроков
- построенное здание должно давать очки лидеру
